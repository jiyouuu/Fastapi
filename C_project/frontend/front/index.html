<!-- <!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¤ STT í…ŒìŠ¤íŠ¸</title>
  <style>
    body { font-family: "Noto Sans KR", sans-serif; text-align:center; margin-top:80px; }
    button { font-size: 18px; padding: 12px 24px; border:none; border-radius:8px; background-color:#6F9F3C; color:white; cursor:pointer; }
    button:disabled { background-color:#ccc; cursor: not-allowed; }
    #result { margin-top: 30px; font-size: 20px; color:#333; white-space: pre-wrap; }
  </style>
</head>
<body>

  <h2>ğŸ™ï¸ ì‹¤ì‹œê°„ ìŒì„± ì¸ì‹ í…ŒìŠ¤íŠ¸</h2>
  <p>3ì´ˆ ë™ì•ˆ ë§í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</p>

  <button id="recordBtn">ğŸ¤ ë…¹ìŒ ì‹œì‘</button>
  <p id="status"></p>
  <div id="result"></div>

  <script>
    const recordBtn = document.getElementById("recordBtn");
    const statusText = document.getElementById("status");
    const resultDiv = document.getElementById("result");
    let mediaRecorder, audioChunks = [];

      recordBtn.onclick = async () => {
    try {
      // ğŸ¤ ë§ˆì´í¬ ì ‘ê·¼ ê¶Œí•œ ìš”ì²­
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });

      // ğŸ™ï¸ ë…¹ìŒê¸° ì´ˆê¸°í™”
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];

      recordBtn.disabled = true;
      statusText.textContent = "ğŸ§ ë…¹ìŒ ì¤‘... 3ì´ˆ ë™ì•ˆ ë§í•´ì£¼ì„¸ìš”.";

      // ğŸ”¹ ìŒì„± ë°ì´í„° ìˆ˜ì§‘ ì´ë²¤íŠ¸
      mediaRecorder.ondataavailable = (e) => {
        if (e.data.size > 0) {
          audioChunks.push(e.data);
        }
      };

      // ğŸ”¹ ë…¹ìŒ ì¢…ë£Œ ì‹œì  ì²˜ë¦¬
      mediaRecorder.onstop = async () => {
        if (audioChunks.length === 0) {
          statusText.textContent = "âš ï¸ ë…¹ìŒëœ ì˜¤ë””ì˜¤ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.";
          recordBtn.disabled = false;
          return;
        }

        // âœ… ë…¹ìŒëœ ì¡°ê°ë“¤ì„ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ í•©ì¹˜ê¸°
        const blob = new Blob(audioChunks, { type: "audio/webm"});
        console.log("ğŸµ Blob í¬ê¸°:", blob.size, "bytes");

        if (blob.size === 0) {
          statusText.textContent = "âš ï¸ ë¹ˆ ì˜¤ë””ì˜¤ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.";
          recordBtn.disabled = false;
          return;
        }

        // ğŸ“¦ ì„œë²„ë¡œ ì „ì†¡ ì¤€ë¹„
        statusText.textContent = "â³ ì„œë²„ë¡œ ì „ì†¡ ì¤‘...";
        const formData = new FormData();
        formData.append("audio_file", blob, "voice.wav");

        try {
          const res = await fetch("http://127.0.0.1:8000/stt", {
            method: "POST",
            body: formData,
          });

          const data = await res.json();

          if (res.ok) {
            statusText.textContent = "âœ… ì¸ì‹ ì™„ë£Œ!";
            resultDiv.textContent = "ê²°ê³¼: " + data.text;
          } else {
            statusText.textContent = "âŒ ì˜¤ë¥˜ ë°œìƒ!";
            resultDiv.textContent = "ì„œë²„ ì˜¤ë¥˜: " + (data.detail || data.error);
          }
        } catch (err) {
          console.error("ì „ì†¡ ì˜¤ë¥˜:", err);
          statusText.textContent = "âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨!";
        } finally {
          recordBtn.disabled = false;
        }
      };

      // ğŸ¬ ë…¹ìŒ ì‹œì‘
      mediaRecorder.start();
      console.log("ë…¹ìŒ ì‹œì‘!");

      // ğŸ•’ 3ì´ˆ ë’¤ ë…¹ìŒ ì¢…ë£Œ
      setTimeout(() => {
        if (mediaRecorder.state !== "inactive") {
          mediaRecorder.stop();
          console.log("ë…¹ìŒ ì¢…ë£Œ!");
        }
      }, 3000);

    } catch (err) {
      console.error("ë§ˆì´í¬ ì˜¤ë¥˜:", err);
      statusText.textContent = "ğŸ¤ ë§ˆì´í¬ ì ‘ê·¼ì´ ê±°ë¶€ë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
    }
  };

  </script>

</body>
</html> -->

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>AI ìŒì„± ìƒë‹´ ì±—ë´‡</title>
  <link rel="stylesheet" href="/src/style.css" />
</head>
<body>
  <div class="chat-container">
    <h2>ğŸ§ AI ìŒì„± ìƒë‹´ ì±—ë´‡</h2>
    <div id="chat-box" class="chat-box"></div>

    <div class="controls">
      <button id="recordBtn">ğŸ¤ ë…¹ìŒí•˜ê¸°</button>
    </div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
